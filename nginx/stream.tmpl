### WARNING: DO NOT EDIT THIS FILE - ALL CHANGES WILL BE LOST!        ###
### THE CONTENTS OF THIS FILE ARE GENERATED AND UPDATED AUTOMATICALLY ###
{{/* */}}
	{{- if .Resolver}}
	resolver {{.Resolver}};{{end -}}
	
	{{range $upstream := .Upstreams}}
	upstream {{$upstream.Name}} {
		{{- if $upstream.Algorithm}}
		{{$upstream.Algorithm}}{{if $upstream.LeastTimeMethod}} {{$upstream.LeastTimeMethod}}{{end}};{{end}}
		{{- range $srv := $upstream.UpstreamServers}}
		server {{$srv.Address}}{{if $srv.Weight}} weight={{- $srv.Weight}}{{end}}{{if $srv.MaxConns}} max_conns={{- $srv.MaxConns}}{{end}}{{if $srv.MaxFails}} max_fails={{- $srv.MaxFails}}{{end}}{{if $srv.FailTimeout}} fail_timeout={{- $srv.FailTimeout}}{{end}}{{if $srv.Backup}} backup{{end}}{{if $srv.Down}} down{{end}};{{end}}
	}
	{{end -}}
	{{range $server := .Servers}}
	server {
		listen {{if $server.Listen.Address}}{{$server.Listen.Address}}:{{end}}{{if $server.Listen.Port}}{{- $server.Listen.Port}}{{end}}{{if $server.Listen.UDP}} udp{{end}};
		
		{{- if $server.ProxyProtocol}} 
		proxy_protocol on;{{end}}

		{{- if $server.ProxyProtocolTimeout}}
		proxy_timeout {{$server.ProxyProtocolTimeout}};{{end}}

		proxy_pass {{$server.ProxyPassAddress}};

		{{if $server.ProxyPassthrough}}proxy_bind $remote_addr transparent;{{end}}
	}
	{{end}}
{{/* */}}